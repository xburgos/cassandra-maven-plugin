<?xml version="1.0"?>
<project>
  <modelVersion>4.0.0</modelVersion>
  <parent>
    <groupId>com.myco.m2</groupId>
    <artifactId>myco-parent</artifactId>
    <version>2.1-SNAPSHOT</version>
    <relativePath>../myco-parent</relativePath>
  </parent>

  <groupId>com.myco.m2</groupId>
  <artifactId>cpkg</artifactId>
  <version>2.1-SNAPSHOT</version>
  <packaging>pom</packaging>

  <properties>
    <primaryPrefix>/opt/myco/p6</primaryPrefix>
    <prefixRoot>${primaryPrefix}</prefixRoot>
    <providedPrefix>${primaryPrefix}/pvd</providedPrefix>
    <prefix>${prefixRoot}</prefix>
    <installDestDir>${project.build.directory}/install</installDestDir>
  </properties>

  <profiles>
    <profile>
      <id>et-arch-profile-x86</id>
      <properties>
      <et.pkg.arch>x86</et.pkg.arch>
      </properties>
      <activation>
        <property>
        <name>os.arch</name>
        <value>i386</value>
        </property>
      </activation>
    </profile>
  </profiles>

  <build>
    <!-- rhoover - we can declare all the plugin versions here so that this is the only place
                    they get specified.  When they need to be rev'ed up, it will be easy to do.
    -->
    <pluginManagement>
      <plugins>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>build-on-demand-maven-plugin</artifactId>
        <version>${cbuildsPluginVersion}</version>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>make-maven-plugin</artifactId>
        <version>${cbuildsPluginVersion}</version>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>rpm-cbuild-maven-plugin</artifactId>
        <version>${cbuildsPluginVersion}</version>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>patch-maven-plugin</artifactId>
        <version>${cbuildsPluginVersion}</version>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>remote-source-maven-plugin</artifactId>
        <version>${cbuildsPluginVersion}</version>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>shell-maven-plugin</artifactId>
        <version>${cbuildsPluginVersion}</version>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>multibuild-optimizer-maven-plugin</artifactId>
        <version>${cbuildsPluginVersion}</version>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>platform-detector-maven-plugin</artifactId>
        <version>${cbuildsPluginVersion}</version>
      </plugin>
      </plugins>
    </pluginManagement>

    <plugins>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>rpm-cbuild-maven-plugin</artifactId>
        <extensions>true</extensions>
        <configuration>
          <prefix>${prefix}</prefix>
          <destDir>${installDestDir}</destDir>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId> 
        <artifactId>platform-detector-maven-plugin</artifactId> 
        <configuration>
          <propertiesOnly>true</propertiesOnly> 
        </configuration>
        <executions>
          <execution>
            <id>P6-style</id> 
            <configuration>
              <osProperty>p6.os</osProperty> 
            </configuration>
            <phase>initialize</phase> 
            <goals>
              <goal>detect</goal> 
            </goals>
          </execution>
          <execution>
            <id>custom-style</id> 
            <configuration>
              <osProperty>et.pkg.os</osProperty> 
              <archProperty>et.pkg.arch</archProperty> 
              <platformPatterns>
                <osPatterns>
                <osPattern>
                  <source>ref:redhat-enterprise</source> 
                  <expression>ref:redhat-enterprise</expression> 
                  <token>rhas$1</token> 
                </osPattern>
                <osPattern>
                  <source>ref:fedora</source> 
                  <expression>ref:fedora</expression> 
                  <token>fc$1</token> 
                </osPattern>
                </osPatterns>
              </platformPatterns>
            </configuration>
            <phase>initialize</phase> 
            <goals>
              <goal>detect</goal> 
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
</project>
